

Berikut adalah kode lengkap untuk file **`public/index.html`**.

Pastikan Anda menyimpan file ini di dalam folder bernama `public`, dan folder `public` tersebut berada sejajar dengan file `server.js`.

```html
<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SSB GARUDA MADINA JAYA - Server Version</title>
    <style>
        :root {
            --primary: #1b5e20; /* Hijau Tua */
            --accent: #ffca28; /* Kuning Emas */
            --bg: #f4f6f8;
            --text: #333;
            --sidebar-w: 260px;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Segoe UI', sans-serif; }

        body { background: var(--bg); color: var(--text); display: flex; height: 100vh; overflow: hidden; }

        /* --- Auth Wrapper --- */
        .auth-wrapper {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: linear-gradient(135deg, var(--primary), #43a047);
            display: flex; justify-content: center; align-items: center; z-index: 999;
        }

        .auth-box {
            background: white; padding: 30px; border-radius: 12px;
            width: 90%; max-width: 400px; box-shadow: 0 10px 25px rgba(0,0,0,0.2);
            text-align: center;
        }

        .auth-logo { width: 70px; height: 70px; border-radius: 50%; margin-bottom: 15px; object-fit: cover; }
        
        .form-group { margin-bottom: 15px; text-align: left; }
        .form-group label { display: block; margin-bottom: 5px; font-size: 0.9rem; color: #666; }
        .form-group input, .form-group select { 
            width: 100%; padding: 10px; border: 1px solid #ccc; border-radius: 6px; font-size: 1rem;
        }

        .btn {
            width: 100%; padding: 12px; border: none; border-radius: 6px;
            cursor: pointer; font-size: 1rem; font-weight: bold; transition: 0.2s;
        }
        .btn-primary { background: var(--primary); color: white; }
        .btn-primary:hover { background: #144a17; }
        .btn-link { background: none; color: var(--primary); text-decoration: underline; margin-top: 10px; font-size: 0.9rem; cursor: pointer; }
        .btn-sm { padding: 5px 10px; font-size: 0.8rem; width: auto; display: inline-block; }
        .btn-edit { background-color: #1976d2; color: white; margin-right: 5px; }

        /* --- App Container --- */
        .app-container { display: none; width: 100%; display: flex; }
        
        /* Sidebar */
        .sidebar {
            width: var(--sidebar-w); background: var(--primary); color: white;
            display: flex; flex-direction: column; padding: 20px;
        }
        .brand { text-align: center; margin-bottom: 30px; padding-bottom: 20px; border-bottom: 1px solid rgba(255,255,255,0.1); }
        .brand img { 
            width: 80px; height: 80px; border-radius: 50%; margin-bottom: 10px; background: white; 
            object-fit: cover; cursor: pointer; transition: transform 0.2s;
        }
        .brand img:hover { transform: scale(1.05); }
        .brand h2 { font-size: 1.2rem; color: var(--accent); }
        
        .nav-menu button {
            background: none; border: none; width: 100%; text-align: left; padding: 12px;
            color: rgba(255,255,255,0.8); cursor: pointer; margin-bottom: 5px; border-radius: 6px; font-size: 1rem;
        }
        .nav-menu button.active, .nav-menu button:hover { background: rgba(255,255,255,0.2); color: white; }
        .logout-btn { margin-top: auto; background: rgba(255,0,0,0.2); color: #ffcdd2; }

        /* Main Content */
        .main-content { flex: 1; padding: 25px; overflow-y: auto; }
        .section { display: none; animation: fadeIn 0.3s; }
        .section.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        .card { background: white; padding: 20px; border-radius: 10px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); margin-bottom: 20px; }
        .header-card h1 { color: var(--primary); margin-bottom: 5px; }

        /* Stats & Summary */
        .stats { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-bottom: 30px; }
        .stat-box { background: white; padding: 20px; border-radius: 10px; box-shadow: 0 2px 5px rgba(0,0,0,0.05); border-left: 5px solid var(--accent); }
        .stat-box h3 { font-size: 0.9rem; color: #666; }
        .stat-box p { font-size: 1.8rem; font-weight: bold; color: var(--primary); }
        .text-danger { color: #d32f2f !important; }
        .text-success { color: #388e3c !important; }

        .spp-summary {
            display: flex; gap: 20px; margin-bottom: 20px; padding: 15px;
            background: #fff8e1; border-radius: 8px; border-left: 5px solid var(--accent);
        }
        .spp-summary-item { flex: 1; }
        .spp-summary-label { font-size: 0.9rem; color: #666; display: block; margin-bottom: 5px; }
        .spp-summary-value { font-size: 1.5rem; font-weight: bold; color: var(--primary); }
        .spp-summary-value.alert { color: #d32f2f; }

        /* Tables */
        .table-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; flex-wrap: wrap; gap: 10px; }
        .week-selector { display: flex; align-items: center; gap: 10px; font-size: 0.9rem; }
        .week-selector select { padding: 8px; border-radius: 4px; border: 1px solid #ccc; }

        .btn-add { background: var(--accent); color: #333; border: none; padding: 10px 20px; border-radius: 6px; cursor: pointer; font-weight: bold; }
        
        table { width: 100%; border-collapse: collapse; background: white; border-radius: 8px; overflow: hidden; }
        th, td { padding: 12px 15px; text-align: left; border-bottom: 1px solid #eee; }
        th { background: #f8f9fa; color: #555; font-weight: 600; }
        tr:hover { background: #fafafa; }

        /* Modal */
        .modal {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.5); display: none; justify-content: center; align-items: center; z-index: 1000;
        }
        .modal.open { display: flex; }
        .modal-content { background: white; padding: 25px; border-radius: 10px; width: 90%; max-width: 400px; }
        .close-modal { float: right; font-size: 1.5rem; cursor: pointer; }

        /* Toast */
        #toast {
            position: fixed; bottom: 20px; right: 20px; background: #333; color: white;
            padding: 12px 24px; border-radius: 5px; opacity: 0; transition: 0.3s; z-index: 2000;
        }
        #toast.show { opacity: 1; bottom: 40px; }

        /* Mobile */
        @media(max-width: 768px) {
            .app-container { flex-direction: column; }
            .sidebar { width: 100%; padding: 10px; flex-direction: row; justify-content: space-between; align-items: center; }
            .nav-menu { display: none; }
            .sidebar.mobile-open .nav-menu { display: flex; flex-direction: column; position: absolute; top: 60px; left: 0; width: 100%; background: var(--primary); padding: 20px; }
            .brand { display: none; }
            .mobile-toggle { display: block; font-size: 1.5rem; cursor: pointer; color: white; background: none; border: none; }
        }
        @media(min-width: 769px) { .mobile-toggle { display: none; } }
    </style>
</head>
<body>

    <!-- Notification Toast -->
    <div id="toast">Pesan notifikasi</div>

    <!-- 1. Halaman Auth (Login & Daftar) -->
    <div id="authSection" class="auth-wrapper">
        
        <!-- Form Login -->
        <div id="loginBox" class="auth-box">
            <img src="https://picsum.photos/seed/garuda/100/100" class="auth-logo" alt="Logo">
            <h2 style="color:var(--primary); margin-bottom:5px;">SSB GARUDA MADINA JAYA</h2>
            <p style="margin-bottom:20px; color:#666;">Silakan Masuk (Server Mode)</p>
            <form onsubmit="handleLogin(event)">
                <div class="form-group">
                    <label>Username</label>
                    <input type="text" id="loginUser" required placeholder="Masukkan username">
                </div>
                <div class="form-group">
                    <label>Password</label>
                    <input type="password" id="loginPass" required placeholder="Masukkan password">
                </div>
                <button type="submit" class="btn btn-primary">MASUK</button>
            </form>
            <button class="btn-link" onclick="toggleAuth('register')">Belum punya akun? Daftar disini</button>
        </div>

        <!-- Form Daftar -->
        <div id="registerBox" class="auth-box" style="display:none;">
            <h2>Daftar Akun Baru</h2>
            <p style="margin-bottom:20px; color:#666;">Isi data pemain di bawah</p>
            <form onsubmit="handleRegister(event)">
                <div class="form-group">
                    <label>Nama Lengkap</label>
                    <input type="text" id="regName" required placeholder="Nama Pemain">
                </div>
                <div class="form-group">
                    <label>Username</label>
                    <input type="text" id="regUser" required placeholder="Buat Username">
                </div>
                <div class="form-group">
                    <label>Password</label>
                    <input type="password" id="regPass" required placeholder="Buat Password">
                </div>
                <button type="submit" class="btn btn-primary">DAFTAR</button>
            </form>
            <button class="btn-link" onclick="toggleAuth('login')">Sudah punya akun? Login disini</button>
        </div>
    </div>

    <!-- 2. Aplikasi Utama -->
    <div id="appSection" class="app-container">
        
        <!-- Sidebar Navigasi -->
        <nav class="sidebar">
            <button class="mobile-toggle" onclick="document.querySelector('.sidebar').classList.toggle('mobile-open')">‚ò∞</button>
            
            <div class="brand">
                <!-- Logo Upload -->
                <img id="appLogo" src="https://picsum.photos/seed/garuda/100/100" alt="Logo" title="Klik untuk ubah Logo" onclick="document.getElementById('logoInput').click()">
                <input type="file" id="logoInput" accept="image/*" style="display: none;" onchange="handleLogoUpload(this)">
                
                <h2>GARUDA MADINA<br>JAYA</h2>
            </div>
            
            <div class="nav-menu">
                <button onclick="nav('dashboard')" id="btn-dash" class="active">üìä Dashboard</button>
                <button onclick="nav('spp')" id="btn-spp">üéì Data SPP Mingguan</button>
                <button onclick="nav('income')" id="btn-income">‚¨ÜÔ∏è Uang Masuk</button>
                <button onclick="nav('expense')" id="btn-expense">‚¨áÔ∏è Uang Keluar</button>
                <button onclick="logout()" class="logout-btn">üö™ Keluar</button>
            </div>
        </nav>

        <!-- Konten Utama -->
        <main class="main-content">
            
            <!-- DASHBOARD -->
            <section id="dashboard" class="section active">
                <div class="card header-card">
                    <h1>Dashboard Keuangan</h1>
                    <p>Data diambil dari Server.</p>
                </div>

                <div class="stats">
                    <div class="stat-box">
                        <h3>Total Saldo Akhir</h3>
                        <p id="totalSaldo">Rp 0</p>
                    </div>
                    <div class="stat-box">
                        <h3>Total Pemasukan</h3>
                        <p id="totalMasuk" style="color:var(--primary)">Rp 0</p>
                    </div>
                    <div class="stat-box">
                        <h3>Total Pengeluaran</h3>
                        <p id="totalKeluar" style="color:#c62828">Rp 0</p>
                    </div>
                    <div class="stat-box">
                        <h3>Total Tunggakan SPP</h3>
                        <p id="totalTunggakanDash" style="color:#d32f2f">Rp 0</p>
                    </div>
                </div>
            </section>

            <!-- FITUR SPP -->
            <section id="spp" class="section">
                <div class="card header-card">
                    <h1>Fitur Pembayaran SPP Mingguan</h1>
                    <p>Masukkan nama pemain secara manual atau dari daftar terdaftar.</p>
                </div>

                <div class="card">
                    <!-- Fitur Jumlah Tunggakan Minggu Ini -->
                    <div class="spp-summary">
                        <div class="spp-summary-item">
                            <span class="spp-summary-label">Total Tunggakan Minggu Ini</span>
                            <span id="weekTotalArrears" class="spp-summary-value alert">Rp 0</span>
                        </div>
                        <div class="spp-summary-item" style="text-align: right;">
                            <span class="spp-summary-label">Pemain Belum Lunas</span>
                            <span id="weekUnpaidCount" class="spp-summary-value">0</span>
                        </div>
                    </div>

                    <div class="table-header">
                        <div class="week-selector">
                            <label>Lihat Minggu:</label>
                            <select id="selectYear" onchange="renderSppTable()"></select>
                            <select id="selectWeek" onchange="renderSppTable()"></select>
                            <button class="btn-add" style="background:#2e7d32; color:white; padding:5px 15px; font-size:0.9rem;" onclick="openAddManual()">+ Input Manual</button>
                        </div>
                    </div>
                    
                    <table>
                        <thead>
                            <tr>
                                <th>Nama Pemain</th>
                                <th>Minggu Ke</th>
                                <th>Status</th>
                                <th>Jumlah Tunggakan</th>
                                <th>Jumlah Bayar</th>
                                <th>Aksi</th>
                            </tr>
                        </thead>
                        <tbody id="sppTableBody">
                            <!-- Data diisi oleh Javascript berdasarkan Pemain dan Minggu -->
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- FITUR UANG MASUK -->
            <section id="income" class="section">
                <div class="card header-card">
                    <h1>Uang Masuk (Lainnya)</h1>
                    <p>Catat pemasukan selain SPP.</p>
                </div>

                <div class="card">
                    <div class="table-header">
                        <h3>Riwayat Uang Masuk</h3>
                        <button class="btn-add" style="background:#2e7d32; color:white;" onclick="openModal('income')">+ Tambah</button>
                    </div>
                    
                    <table>
                        <thead>
                            <tr>
                                <th>Tanggal</th>
                                <th>Keterangan</th>
                                <th>Jumlah</th>
                            </tr>
                        </thead>
                        <tbody id="incomeTableBody">
                            <!-- Data diisi oleh Javascript -->
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- FITUR UANG KELUAR -->
            <section id="expense" class="section">
                <div class="card header-card">
                    <h1>Uang Keluar</h1>
                    <p>Catat pengeluaran operasional.</p>
                </div>

                <div class="card">
                    <div class="table-header">
                        <h3>Riwayat Uang Keluar</h3>
                        <button class="btn-add" style="background:#c62828; color:white;" onclick="openModal('expense')">+ Catat</button>
                    </div>
                    
                    <table>
                        <thead>
                            <tr>
                                <th>Tanggal</th>
                                <th>Keterangan</th>
                                <th>Jumlah</th>
                            </tr>
                        </thead>
                        <tbody id="expenseTableBody">
                            <!-- Data diisi oleh Javascript -->
                        </tbody>
                    </table>
                </div>
            </section>

        </main>
    </div>

    <!-- Modal SPP (Add/Edit) -->
    <div id="modalSpp" class="modal">
        <div class="modal-content">
            <span class="close-modal" onclick="closeModal()">&times;</span>
            <h3 id="modalSppTitle" style="margin-bottom:20px; color:var(--primary);">Input Pembayaran SPP</h3>
            <form onsubmit="submitPembayaran(event)">
                <input type="hidden" id="editSppId">
                <input type="hidden" id="editPlayerName">
                
                <div class="form-group">
                    <label>Nama Pemain</label>
                    <!-- Diubah menjadi input biasa (bukan readonly) untuk memenuhi permintaan manual -->
                    <input type="text" id="inputPemain" required placeholder="Ketik nama pemain...">
                </div>
                <div class="form-group">
                    <label>Minggu Ke</label>
                    <div style="display:flex; gap:10px;">
                        <input type="number" id="inputWeek" required>
                        <input type="number" id="inputYear" required>
                    </div>
                </div>
                <div class="form-group">
                    <label>Tanggal Bayar</label>
                    <input type="date" id="inputTanggal" required>
                </div>
                <div class="form-group">
                    <label>Jumlah Bayar (Rp)</label>
                    <input type="number" id="inputJumlah" required placeholder="0">
                    <small style="color:#666;">Biaya SPP Mingguan: <strong>Rp 10.000</strong></small>
                </div>
                <button type="submit" class="btn btn-primary">Simpan</button>
            </form>
        </div>
    </div>

    <!-- Modal Uang Masuk -->
    <div id="modalIncome" class="modal">
        <div class="modal-content">
            <span class="close-modal" onclick="closeModal()">&times;</span>
            <h3 style="margin-bottom:20px; color:#2e7d32;">Tambah Uang Masuk</h3>
            <form onsubmit="submitTransaction(event, 'in')">
                <div class="form-group">
                    <label>Keterangan</label>
                    <input type="text" id="inputKetIn" required placeholder="Contoh: Donasi Sponsor">
                </div>
                <div class="form-group">
                    <label>Tanggal</label>
                    <input type="date" id="inputDateIn" required>
                </div>
                <div class="form-group">
                    <label>Jumlah (Rp)</label>
                    <input type="number" id="inputJmlIn" required placeholder="0">
                </div>
                <button type="submit" class="btn btn-primary" style="background-color:#2e7d32">Simpan</button>
            </form>
        </div>
    </div>

    <!-- Modal Uang Keluar -->
    <div id="modalExpense" class="modal">
        <div class="modal-content">
            <span class="close-modal" onclick="closeModal()">&times;</span>
            <h3 style="margin-bottom:20px; color:#c62828;">Catat Uang Keluar</h3>
            <form onsubmit="submitTransaction(event, 'out')">
                <div class="form-group">
                    <label>Keterangan</label>
                    <input type="text" id="inputKetOut" required placeholder="Contoh: Beli Bola Baru">
                </div>
                <div class="form-group">
                    <label>Tanggal</label>
                    <input type="date" id="inputDateOut" required>
                </div>
                <div class="form-group">
                    <label>Jumlah (Rp)</label>
                    <input type="number" id="inputJmlOut" required placeholder="0">
                </div>
                <button type="submit" class="btn btn-primary" style="background-color:#c62828">Simpan</button>
            </form>
        </div>
    </div>

    <script>
        // --- KONFIGURASI ---
        const BIAYA_SPP = 10000;
        const API_URL = 'http://localhost:3000/api'; // URL Server Backend
        let state = { users: [], transactions: [] };
        let currentUser = null;

        // --- API HELPERS ---
        async function apiRegister(data) {
            const res = await fetch(`${API_URL}/register`, {
                method: 'POST', headers: {'Content-Type': 'application/json'}, body: JSON.stringify(data)
            });
            return res.json();
        }

        async function apiLogin(data) {
            const res = await fetch(`${API_URL}/login`, {
                method: 'POST', headers: {'Content-Type': 'application/json'}, body: JSON.stringify(data)
            });
            return res.json();
        }

        async function apiAddTransaction(data) {
            const res = await fetch(`${API_URL}/transactions`, {
                method: 'POST', headers: {'Content-Type': 'application/json'}, body: JSON.stringify(data)
            });
            return res.json();
        }

        async function apiUpdateTransaction(id, data) {
            const res = await fetch(`${API_URL}/transactions/${id}`, {
                method: 'PUT', headers: {'Content-Type': 'application/json'}, body: JSON.stringify(data)
            });
            return res.json();
        }

        async function fetchData() {
            const res = await fetch(`${API_URL}/data`);
            return res.json();
        }

        // --- INIT ---
        async function init() {
            // Load Logo Local
            const savedLogo = localStorage.getItem('ssb_logo');
            if(savedLogo) document.getElementById('appLogo').src = savedLogo;

            const today = new Date();
            const w = getWeekNumber(today);
            populateWeekSelectors(w.year, w.week);

            const session = sessionStorage.getItem('ssb_user_server');
            if (session) {
                currentUser = JSON.parse(session);
                await loadAppData();
            }
        }

        async function loadAppData() {
            try {
                state = await fetchData();
                document.getElementById('authSection').style.display = 'none';
                document.getElementById('appSection').style.display = 'flex';
                updateUI();
            } catch (err) {
                console.error(err);
                showToast("Gagal mengambil data dari server", true);
            }
        }

        // --- AUTH ---
        function toggleAuth(type) {
            document.getElementById('loginBox').style.display = type === 'login' ? 'block' : 'none';
            document.getElementById('registerBox').style.display = type === 'register' ? 'block' : 'none';
        }

        async function handleLogin(e) {
            e.preventDefault();
            const u = document.getElementById('loginUser').value;
            const p = document.getElementById('loginPass').value;
            const res = await apiLogin({ username: u, password: p });
            
            if(res.user) {
                currentUser = res.user;
                sessionStorage.setItem('ssb_user_server', JSON.stringify(currentUser));
                showToast("Login Berhasil!");
                await loadAppData();
            } else {
                showToast(res.message || "Login Gagal", true);
            }
        }

        async function handleRegister(e) {
            e.preventDefault();
            const data = {
                name: document.getElementById('regName').value,
                username: document.getElementById('regUser').value,
                password: document.getElementById('regPass').value
            };
            const res = await apiRegister(data);
            if(res.user) {
                showToast("Registrasi Berhasil! Silakan Login.");
                toggleAuth('login');
            } else {
                showToast(res.message, true);
            }
        }

        function logout() {
            sessionStorage.removeItem('ssb_user_server');
            location.reload();
        }

        // --- CORE LOGIC ---
        function updateUI() {
            // Kalkulasi Dashboard
            let income = 0, expense = 0, totalTunggakan = 0;
            state.transactions.forEach(t => {
                const amt = parseInt(t.amount);
                if(t.type === 'in' || t.type === 'spp') income += amt;
                if(t.type === 'out') expense += amt;
                if(t.type === 'spp') {
                    const tg = BIAYA_SPP - amt;
                    if(tg > 0) totalTunggakan += tg;
                }
            });
            const saldo = income - expense;
            document.getElementById('totalSaldo').innerText = formatRupiah(saldo);
            document.getElementById('totalMasuk').innerText = formatRupiah(income);
            document.getElementById('totalKeluar').innerText = formatRupiah(expense);
            document.getElementById('totalTunggakanDash').innerText = formatRupiah(totalTunggakan);

            // Update Tables Income/Expense
            const inBody = document.getElementById('incomeTableBody');
            inBody.innerHTML = state.transactions.filter(t => t.type === 'in').sort((a,b)=>new Date(b.date)-new Date(a.date))
                .map(t => `<tr><td>${t.date}</td><td>${t.desc}</td><td>${formatRupiah(t.amount)}</td></tr>`).join('');

            const outBody = document.getElementById('expenseTableBody');
            outBody.innerHTML = state.transactions.filter(t => t.type === 'out').sort((a,b)=>new Date(b.date)-new Date(a.date))
                .map(t => `<tr><td>${t.date}</td><td>${t.desc}</td><td>${formatRupiah(t.amount)}</td></tr>`).join('');
            
            if(document.getElementById('spp').classList.contains('active')) renderSppTable();
        }

        function renderSppTable() {
            const sppBody = document.getElementById('sppTableBody');
            sppBody.innerHTML = '';
            const selectedYear = parseInt(document.getElementById('selectYear').value);
            const selectedWeek = parseInt(document.getElementById('selectWeek').value);
            
            let uniqueNames = new Set([...state.users.map(u=>u.name), ...state.transactions.filter(t=>t.type==='spp').map(t=>t.playerName)]);
            let sortedNames = Array.from(uniqueNames).sort();
            
            let weekTotalArrears = 0; let unpaidCount = 0;

            sortedNames.forEach(playerName => {
                const existingTrans = state.transactions.find(t => t.type==='spp' && t.playerName===playerName && t.year===selectedYear && t.week===selectedWeek);
                
                let status = '<span style="color:#999;">Belum Bayar</span>';
                let amountDisplay = '-';
                let actionBtn = `<button onclick="openSppModal('${playerName}', ${selectedYear}, ${selectedWeek})" class="btn btn-sm btn-edit">Bayar</button>`;
                let currentTunggakan = BIAYA_SPP;
                let tunggakanText = '';

                if(existingTrans) {
                    const tunggakan = BIAYA_SPP - existingTrans.amount;
                    currentTunggakan = tunggakan > 0 ? tunggakan : 0;
                    if(tunggakan > 0) {
                        status = '<span style="background:#ffebee; color:#c62828; padding:2px 8px; border-radius:4px; font-size:0.8rem;">Kurang</span>';
                        tunggakanText = `<div style="font-size:0.8rem; color:#d32f2f;">Tunggakan: ${formatRupiah(tunggakan)}</div>`;
                    } else {
                        status = '<span style="background:#e8f5e9; color:#2e7d32; padding:2px 8px; border-radius:4px; font-size:0.8rem;">Lunas</span>';
                    }
                    amountDisplay = formatRupiah(existingTrans.amount);
                    actionBtn = `<button onclick="editSpp(${existingTrans.id})" class="btn btn-sm btn-edit">Edit</button>`;
                } else {
                    tunggakanText = `<div style="font-size:0.8rem; color:#d32f2f;">Tunggakan: ${formatRupiah(BIAYA_SPP)}</div>`;
                }

                if(currentTunggakan > 0) { weekTotalArrears += currentTunggakan; unpaidCount++; }

                sppBody.innerHTML += `
                    <tr>
                        <td><strong>${playerName}</strong></td>
                        <td>Minggu ${selectedWeek} (${selectedYear})</td>
                        <td>${status} ${tunggakanText}</td>
                        <td style="color:${currentTunggakan > 0 ? '#d32f2f' : '#388e3c'}; font-weight:bold;">${formatRupiah(currentTunggakan)}</td>
                        <td style="font-weight:bold;">${amountDisplay}</td>
                        <td>${actionBtn}</td>
                    </tr>`;
            });

            document.getElementById('weekTotalArrears').innerText = formatRupiah(weekTotalArrears);
            document.getElementById('weekUnpaidCount').innerText = unpaidCount;
        }

        // --- ACTIONS ---
        async function submitPembayaran(e) {
            e.preventDefault();
            const editId = document.getElementById('editSppId').value;
            const playerName = document.getElementById('inputPemain').value;
            const year = parseInt(document.getElementById('inputYear').value);
            const week = parseInt(document.getElementById('inputWeek').value);
            const tanggal = document.getElementById('inputTanggal').value;
            const jumlah = parseInt(document.getElementById('inputJumlah').value);
            
            const weekDateObj = getWeekNumber(new Date(tanggal));

            if (editId) {
                await apiUpdateTransaction(editId, {
                    playerName, date: tanggal, amount: jumlah,
                    year: weekDateObj.year, week: weekDateObj.week
                });
            } else {
                await apiAddTransaction({
                    type: 'spp', playerName, date: tanggal, amount: jumlah,
                    desc: 'Pembayaran SPP', year: weekDateObj.year, week: weekDateObj.week
                });
            }
            closeModal(); showToast("SPP Disimpan");
            await loadAppData(); // Refresh data
        }

        async function submitTransaction(e, type) {
            e.preventDefault();
            const ket = document.getElementById(`inputKet${type==='in'?'In':'Out'}`).value;
            const tgl = document.getElementById(`inputDate${type==='in'?'In':'Out'}`).value;
            const jml = document.getElementById(`inputJml${type==='in'?'In':'Out'}`).value;
            
            await apiAddTransaction({ type, date: tgl, amount: jml, desc: ket });
            closeModal(); showToast("Data Disimpan");
            await loadAppData();
        }

        // --- HELPERS ---
        function openSppModal(name, y, w) {
            document.getElementById('editSppId').value = '';
            document.getElementById('editPlayerName').value = name;
            document.getElementById('inputPemain').value = name;
            document.getElementById('inputYear').value = y;
            document.getElementById('inputWeek').value = w;
            document.getElementById('inputJumlah').value = '';
            document.getElementById('modalSppTitle').innerText = 'Input Pembayaran SPP';
            document.getElementById('inputTanggal').valueAsDate = new Date();
            document.getElementById('modalSpp').classList.add('open');
        }

        function editSpp(id) {
            const t = state.transactions.find(x => x.id === id);
            if(t) {
                document.getElementById('editSppId').value = t.id;
                document.getElementById('editPlayerName').value = t.playerName;
                document.getElementById('inputPemain').value = t.playerName;
                document.getElementById('inputYear').value = t.year;
                document.getElementById('inputWeek').value = t.week;
                document.getElementById('inputTanggal').value = t.date;
                document.getElementById('inputJumlah').value = t.amount;
                document.getElementById('modalSppTitle').innerText = 'Edit Pembayaran SPP';
                document.getElementById('modalSpp').classList.add('open');
            }
        }

        function getWeekNumber(d) {
            d = new Date(Date.UTC(d.getFullYear(), d.getMonth(), d.getDate()));
            d.setUTCDate(d.getUTCDate() + 4 - (d.getUTCDay()||7));
            var yearStart = new Date(Date.UTC(d.getUTCFullYear(),0,1));
            var weekNo = Math.ceil(( ( (d - yearStart) / 86400000) + 1)/7);
            return { year: d.getUTCFullYear(), week: weekNo };
        }

        function populateWeekSelectors(y, w) {
            const ySel = document.getElementById('selectYear');
            const wSel = document.getElementById('selectWeek');
            ySel.innerHTML = ''; wSel.innerHTML = '';
            for(let i=y-1; i<=y+1; i++) ySel.add(new Option(i, i, false, i===y));
            for(let i=1; i<=53; i++) wSel.add(new Option(i, i, false, i===w));
        }

        function formatRupiah(a) { return 'Rp ' + parseInt(a).toLocaleString('id-ID'); }
        
        function showToast(msg, err) {
            const t = document.getElementById('toast'); t.innerText = msg;
            t.style.background = err ? '#d32f2f' : '#333'; t.classList.add('show');
            setTimeout(()=>t.classList.remove('show'), 3000);
        }

        function handleLogoUpload(input) {
            if(input.files && input.files[0]) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    document.getElementById('appLogo').src = e.target.result;
                    localStorage.setItem('ssb_logo', e.target.result);
                    showToast("Logo tersimpan di browser ini");
                };
                reader.readAsDataURL(input.files[0]);
            }
        }

        // Navigation & Modal Utils
        function nav(id) {
            document.querySelectorAll('.section').forEach(e=>e.classList.remove('active'));
            document.getElementById(id).classList.add('active');
            document.querySelectorAll('.nav-menu button').forEach(e=>e.classList.remove('active'));
            document.getElementById('btn-'+id).classList.add('active');
            if(id==='spp') renderSppTable();
        }
        function openModal(t) { document.getElementById('modal'+(t.charAt(0).toUpperCase()+t.slice(1))).classList.add('open'); }
        function closeModal() { document.querySelectorAll('.modal').forEach(m=>m.classList.remove('open')); }
        function openAddManual() { openSppModal('', parseInt(document.getElementById('selectYear').value), parseInt(document.getElementById('selectWeek').value)); document.getElementById('inputPemain').focus(); }

        init();
    </script>
</body>
</html>
```

Berikut adalah kode lengkap untuk file **`public/index.html`**.

Pastikan Anda menyimpan file ini di dalam folder bernama `public`, dan folder `public` tersebut berada sejajar dengan file `server.js`.

```html
<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SSB GARUDA MADINA JAYA - Server Version</title>
    <style>
        :root {
            --primary: #1b5e20; /* Hijau Tua */
            --accent: #ffca28; /* Kuning Emas */
            --bg: #f4f6f8;
            --text: #333;
            --sidebar-w: 260px;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Segoe UI', sans-serif; }

        body { background: var(--bg); color: var(--text); display: flex; height: 100vh; overflow: hidden; }

        /* --- Auth Wrapper --- */
        .auth-wrapper {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: linear-gradient(135deg, var(--primary), #43a047);
            display: flex; justify-content: center; align-items: center; z-index: 999;
        }

        .auth-box {
            background: white; padding: 30px; border-radius: 12px;
            width: 90%; max-width: 400px; box-shadow: 0 10px 25px rgba(0,0,0,0.2);
            text-align: center;
        }

        .auth-logo { width: 70px; height: 70px; border-radius: 50%; margin-bottom: 15px; object-fit: cover; }
        
        .form-group { margin-bottom: 15px; text-align: left; }
        .form-group label { display: block; margin-bottom: 5px; font-size: 0.9rem; color: #666; }
        .form-group input, .form-group select { 
            width: 100%; padding: 10px; border: 1px solid #ccc; border-radius: 6px; font-size: 1rem;
        }

        .btn {
            width: 100%; padding: 12px; border: none; border-radius: 6px;
            cursor: pointer; font-size: 1rem; font-weight: bold; transition: 0.2s;
        }
        .btn-primary { background: var(--primary); color: white; }
        .btn-primary:hover { background: #144a17; }
        .btn-link { background: none; color: var(--primary); text-decoration: underline; margin-top: 10px; font-size: 0.9rem; cursor: pointer; }
        .btn-sm { padding: 5px 10px; font-size: 0.8rem; width: auto; display: inline-block; }
        .btn-edit { background-color: #1976d2; color: white; margin-right: 5px; }

        /* --- App Container --- */
        .app-container { display: none; width: 100%; display: flex; }
        
        /* Sidebar */
        .sidebar {
            width: var(--sidebar-w); background: var(--primary); color: white;
            display: flex; flex-direction: column; padding: 20px;
        }
        .brand { text-align: center; margin-bottom: 30px; padding-bottom: 20px; border-bottom: 1px solid rgba(255,255,255,0.1); }
        .brand img { 
            width: 80px; height: 80px; border-radius: 50%; margin-bottom: 10px; background: white; 
            object-fit: cover; cursor: pointer; transition: transform 0.2s;
        }
        .brand img:hover { transform: scale(1.05); }
        .brand h2 { font-size: 1.2rem; color: var(--accent); }
        
        .nav-menu button {
            background: none; border: none; width: 100%; text-align: left; padding: 12px;
            color: rgba(255,255,255,0.8); cursor: pointer; margin-bottom: 5px; border-radius: 6px; font-size: 1rem;
        }
        .nav-menu button.active, .nav-menu button:hover { background: rgba(255,255,255,0.2); color: white; }
        .logout-btn { margin-top: auto; background: rgba(255,0,0,0.2); color: #ffcdd2; }

        /* Main Content */
        .main-content { flex: 1; padding: 25px; overflow-y: auto; }
        .section { display: none; animation: fadeIn 0.3s; }
        .section.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        .card { background: white; padding: 20px; border-radius: 10px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); margin-bottom: 20px; }
        .header-card h1 { color: var(--primary); margin-bottom: 5px; }

        /* Stats & Summary */
        .stats { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-bottom: 30px; }
        .stat-box { background: white; padding: 20px; border-radius: 10px; box-shadow: 0 2px 5px rgba(0,0,0,0.05); border-left: 5px solid var(--accent); }
        .stat-box h3 { font-size: 0.9rem; color: #666; }
        .stat-box p { font-size: 1.8rem; font-weight: bold; color: var(--primary); }
        .text-danger { color: #d32f2f !important; }
        .text-success { color: #388e3c !important; }

        .spp-summary {
            display: flex; gap: 20px; margin-bottom: 20px; padding: 15px;
            background: #fff8e1; border-radius: 8px; border-left: 5px solid var(--accent);
        }
        .spp-summary-item { flex: 1; }
        .spp-summary-label { font-size: 0.9rem; color: #666; display: block; margin-bottom: 5px; }
        .spp-summary-value { font-size: 1.5rem; font-weight: bold; color: var(--primary); }
        .spp-summary-value.alert { color: #d32f2f; }

        /* Tables */
        .table-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; flex-wrap: wrap; gap: 10px; }
        .week-selector { display: flex; align-items: center; gap: 10px; font-size: 0.9rem; }
        .week-selector select { padding: 8px; border-radius: 4px; border: 1px solid #ccc; }

        .btn-add { background: var(--accent); color: #333; border: none; padding: 10px 20px; border-radius: 6px; cursor: pointer; font-weight: bold; }
        
        table { width: 100%; border-collapse: collapse; background: white; border-radius: 8px; overflow: hidden; }
        th, td { padding: 12px 15px; text-align: left; border-bottom: 1px solid #eee; }
        th { background: #f8f9fa; color: #555; font-weight: 600; }
        tr:hover { background: #fafafa; }

        /* Modal */
        .modal {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.5); display: none; justify-content: center; align-items: center; z-index: 1000;
        }
        .modal.open { display: flex; }
        .modal-content { background: white; padding: 25px; border-radius: 10px; width: 90%; max-width: 400px; }
        .close-modal { float: right; font-size: 1.5rem; cursor: pointer; }

        /* Toast */
        #toast {
            position: fixed; bottom: 20px; right: 20px; background: #333; color: white;
            padding: 12px 24px; border-radius: 5px; opacity: 0; transition: 0.3s; z-index: 2000;
        }
        #toast.show { opacity: 1; bottom: 40px; }

        /* Mobile */
        @media(max-width: 768px) {
            .app-container { flex-direction: column; }
            .sidebar { width: 100%; padding: 10px; flex-direction: row; justify-content: space-between; align-items: center; }
            .nav-menu { display: none; }
            .sidebar.mobile-open .nav-menu { display: flex; flex-direction: column; position: absolute; top: 60px; left: 0; width: 100%; background: var(--primary); padding: 20px; }
            .brand { display: none; }
            .mobile-toggle { display: block; font-size: 1.5rem; cursor: pointer; color: white; background: none; border: none; }
        }
        @media(min-width: 769px) { .mobile-toggle { display: none; } }
    </style>
</head>
<body>

    <!-- Notification Toast -->
    <div id="toast">Pesan notifikasi</div>

    <!-- 1. Halaman Auth (Login & Daftar) -->
    <div id="authSection" class="auth-wrapper">
        
        <!-- Form Login -->
        <div id="loginBox" class="auth-box">
            <img src="https://picsum.photos/seed/garuda/100/100" class="auth-logo" alt="Logo">
            <h2 style="color:var(--primary); margin-bottom:5px;">SSB GARUDA MADINA JAYA</h2>
            <p style="margin-bottom:20px; color:#666;">Silakan Masuk (Server Mode)</p>
            <form onsubmit="handleLogin(event)">
                <div class="form-group">
                    <label>Username</label>
                    <input type="text" id="loginUser" required placeholder="Masukkan username">
                </div>
                <div class="form-group">
                    <label>Password</label>
                    <input type="password" id="loginPass" required placeholder="Masukkan password">
                </div>
                <button type="submit" class="btn btn-primary">MASUK</button>
            </form>
            <button class="btn-link" onclick="toggleAuth('register')">Belum punya akun? Daftar disini</button>
        </div>

        <!-- Form Daftar -->
        <div id="registerBox" class="auth-box" style="display:none;">
            <h2>Daftar Akun Baru</h2>
            <p style="margin-bottom:20px; color:#666;">Isi data pemain di bawah</p>
            <form onsubmit="handleRegister(event)">
                <div class="form-group">
                    <label>Nama Lengkap</label>
                    <input type="text" id="regName" required placeholder="Nama Pemain">
                </div>
                <div class="form-group">
                    <label>Username</label>
                    <input type="text" id="regUser" required placeholder="Buat Username">
                </div>
                <div class="form-group">
                    <label>Password</label>
                    <input type="password" id="regPass" required placeholder="Buat Password">
                </div>
                <button type="submit" class="btn btn-primary">DAFTAR</button>
            </form>
            <button class="btn-link" onclick="toggleAuth('login')">Sudah punya akun? Login disini</button>
        </div>
    </div>

    <!-- 2. Aplikasi Utama -->
    <div id="appSection" class="app-container">
        
        <!-- Sidebar Navigasi -->
        <nav class="sidebar">
            <button class="mobile-toggle" onclick="document.querySelector('.sidebar').classList.toggle('mobile-open')">‚ò∞</button>
            
            <div class="brand">
                <!-- Logo Upload -->
                <img id="appLogo" src="https://picsum.photos/seed/garuda/100/100" alt="Logo" title="Klik untuk ubah Logo" onclick="document.getElementById('logoInput').click()">
                <input type="file" id="logoInput" accept="image/*" style="display: none;" onchange="handleLogoUpload(this)">
                
                <h2>GARUDA MADINA<br>JAYA</h2>
            </div>
            
            <div class="nav-menu">
                <button onclick="nav('dashboard')" id="btn-dash" class="active">üìä Dashboard</button>
                <button onclick="nav('spp')" id="btn-spp">üéì Data SPP Mingguan</button>
                <button onclick="nav('income')" id="btn-income">‚¨ÜÔ∏è Uang Masuk</button>
                <button onclick="nav('expense')" id="btn-expense">‚¨áÔ∏è Uang Keluar</button>
                <button onclick="logout()" class="logout-btn">üö™ Keluar</button>
            </div>
        </nav>

        <!-- Konten Utama -->
        <main class="main-content">
            
            <!-- DASHBOARD -->
            <section id="dashboard" class="section active">
                <div class="card header-card">
                    <h1>Dashboard Keuangan</h1>
                    <p>Data diambil dari Server.</p>
                </div>

                <div class="stats">
                    <div class="stat-box">
                        <h3>Total Saldo Akhir</h3>
                        <p id="totalSaldo">Rp 0</p>
                    </div>
                    <div class="stat-box">
                        <h3>Total Pemasukan</h3>
                        <p id="totalMasuk" style="color:var(--primary)">Rp 0</p>
                    </div>
                    <div class="stat-box">
                        <h3>Total Pengeluaran</h3>
                        <p id="totalKeluar" style="color:#c62828">Rp 0</p>
                    </div>
                    <div class="stat-box">
                        <h3>Total Tunggakan SPP</h3>
                        <p id="totalTunggakanDash" style="color:#d32f2f">Rp 0</p>
                    </div>
                </div>
            </section>

            <!-- FITUR SPP -->
            <section id="spp" class="section">
                <div class="card header-card">
                    <h1>Fitur Pembayaran SPP Mingguan</h1>
                    <p>Masukkan nama pemain secara manual atau dari daftar terdaftar.</p>
                </div>

                <div class="card">
                    <!-- Fitur Jumlah Tunggakan Minggu Ini -->
                    <div class="spp-summary">
                        <div class="spp-summary-item">
                            <span class="spp-summary-label">Total Tunggakan Minggu Ini</span>
                            <span id="weekTotalArrears" class="spp-summary-value alert">Rp 0</span>
                        </div>
                        <div class="spp-summary-item" style="text-align: right;">
                            <span class="spp-summary-label">Pemain Belum Lunas</span>
                            <span id="weekUnpaidCount" class="spp-summary-value">0</span>
                        </div>
                    </div>

                    <div class="table-header">
                        <div class="week-selector">
                            <label>Lihat Minggu:</label>
                            <select id="selectYear" onchange="renderSppTable()"></select>
                            <select id="selectWeek" onchange="renderSppTable()"></select>
                            <button class="btn-add" style="background:#2e7d32; color:white; padding:5px 15px; font-size:0.9rem;" onclick="openAddManual()">+ Input Manual</button>
                        </div>
                    </div>
                    
                    <table>
                        <thead>
                            <tr>
                                <th>Nama Pemain</th>
                                <th>Minggu Ke</th>
                                <th>Status</th>
                                <th>Jumlah Tunggakan</th>
                                <th>Jumlah Bayar</th>
                                <th>Aksi</th>
                            </tr>
                        </thead>
                        <tbody id="sppTableBody">
                            <!-- Data diisi oleh Javascript berdasarkan Pemain dan Minggu -->
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- FITUR UANG MASUK -->
            <section id="income" class="section">
                <div class="card header-card">
                    <h1>Uang Masuk (Lainnya)</h1>
                    <p>Catat pemasukan selain SPP.</p>
                </div>

                <div class="card">
                    <div class="table-header">
                        <h3>Riwayat Uang Masuk</h3>
                        <button class="btn-add" style="background:#2e7d32; color:white;" onclick="openModal('income')">+ Tambah</button>
                    </div>
                    
                    <table>
                        <thead>
                            <tr>
                                <th>Tanggal</th>
                                <th>Keterangan</th>
                                <th>Jumlah</th>
                            </tr>
                        </thead>
                        <tbody id="incomeTableBody">
                            <!-- Data diisi oleh Javascript -->
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- FITUR UANG KELUAR -->
            <section id="expense" class="section">
                <div class="card header-card">
                    <h1>Uang Keluar</h1>
                    <p>Catat pengeluaran operasional.</p>
                </div>

                <div class="card">
                    <div class="table-header">
                        <h3>Riwayat Uang Keluar</h3>
                        <button class="btn-add" style="background:#c62828; color:white;" onclick="openModal('expense')">+ Catat</button>
                    </div>
                    
                    <table>
                        <thead>
                            <tr>
                                <th>Tanggal</th>
                                <th>Keterangan</th>
                                <th>Jumlah</th>
                            </tr>
                        </thead>
                        <tbody id="expenseTableBody">
                            <!-- Data diisi oleh Javascript -->
                        </tbody>
                    </table>
                </div>
            </section>

        </main>
    </div>

    <!-- Modal SPP (Add/Edit) -->
    <div id="modalSpp" class="modal">
        <div class="modal-content">
            <span class="close-modal" onclick="closeModal()">&times;</span>
            <h3 id="modalSppTitle" style="margin-bottom:20px; color:var(--primary);">Input Pembayaran SPP</h3>
            <form onsubmit="submitPembayaran(event)">
                <input type="hidden" id="editSppId">
                <input type="hidden" id="editPlayerName">
                
                <div class="form-group">
                    <label>Nama Pemain</label>
                    <!-- Diubah menjadi input biasa (bukan readonly) untuk memenuhi permintaan manual -->
                    <input type="text" id="inputPemain" required placeholder="Ketik nama pemain...">
                </div>
                <div class="form-group">
                    <label>Minggu Ke</label>
                    <div style="display:flex; gap:10px;">
                        <input type="number" id="inputWeek" required>
                        <input type="number" id="inputYear" required>
                    </div>
                </div>
                <div class="form-group">
                    <label>Tanggal Bayar</label>
                    <input type="date" id="inputTanggal" required>
                </div>
                <div class="form-group">
                    <label>Jumlah Bayar (Rp)</label>
                    <input type="number" id="inputJumlah" required placeholder="0">
                    <small style="color:#666;">Biaya SPP Mingguan: <strong>Rp 10.000</strong></small>
                </div>
                <button type="submit" class="btn btn-primary">Simpan</button>
            </form>
        </div>
    </div>

    <!-- Modal Uang Masuk -->
    <div id="modalIncome" class="modal">
        <div class="modal-content">
            <span class="close-modal" onclick="closeModal()">&times;</span>
            <h3 style="margin-bottom:20px; color:#2e7d32;">Tambah Uang Masuk</h3>
            <form onsubmit="submitTransaction(event, 'in')">
                <div class="form-group">
                    <label>Keterangan</label>
                    <input type="text" id="inputKetIn" required placeholder="Contoh: Donasi Sponsor">
                </div>
                <div class="form-group">
                    <label>Tanggal</label>
                    <input type="date" id="inputDateIn" required>
                </div>
                <div class="form-group">
                    <label>Jumlah (Rp)</label>
                    <input type="number" id="inputJmlIn" required placeholder="0">
                </div>
                <button type="submit" class="btn btn-primary" style="background-color:#2e7d32">Simpan</button>
            </form>
        </div>
    </div>

    <!-- Modal Uang Keluar -->
    <div id="modalExpense" class="modal">
        <div class="modal-content">
            <span class="close-modal" onclick="closeModal()">&times;</span>
            <h3 style="margin-bottom:20px; color:#c62828;">Catat Uang Keluar</h3>
            <form onsubmit="submitTransaction(event, 'out')">
                <div class="form-group">
                    <label>Keterangan</label>
                    <input type="text" id="inputKetOut" required placeholder="Contoh: Beli Bola Baru">
                </div>
                <div class="form-group">
                    <label>Tanggal</label>
                    <input type="date" id="inputDateOut" required>
                </div>
                <div class="form-group">
                    <label>Jumlah (Rp)</label>
                    <input type="number" id="inputJmlOut" required placeholder="0">
                </div>
                <button type="submit" class="btn btn-primary" style="background-color:#c62828">Simpan</button>
            </form>
        </div>
    </div>

    <script>
        // --- KONFIGURASI ---
        const BIAYA_SPP = 10000;
        const API_URL = 'http://localhost:3000/api'; // URL Server Backend
        let state = { users: [], transactions: [] };
        let currentUser = null;

        // --- API HELPERS ---
        async function apiRegister(data) {
            const res = await fetch(`${API_URL}/register`, {
                method: 'POST', headers: {'Content-Type': 'application/json'}, body: JSON.stringify(data)
            });
            return res.json();
        }

        async function apiLogin(data) {
            const res = await fetch(`${API_URL}/login`, {
                method: 'POST', headers: {'Content-Type': 'application/json'}, body: JSON.stringify(data)
            });
            return res.json();
        }

        async function apiAddTransaction(data) {
            const res = await fetch(`${API_URL}/transactions`, {
                method: 'POST', headers: {'Content-Type': 'application/json'}, body: JSON.stringify(data)
            });
            return res.json();
        }

        async function apiUpdateTransaction(id, data) {
            const res = await fetch(`${API_URL}/transactions/${id}`, {
                method: 'PUT', headers: {'Content-Type': 'application/json'}, body: JSON.stringify(data)
            });
            return res.json();
        }

        async function fetchData() {
            const res = await fetch(`${API_URL}/data`);
            return res.json();
        }

        // --- INIT ---
        async function init() {
            // Load Logo Local
            const savedLogo = localStorage.getItem('ssb_logo');
            if(savedLogo) document.getElementById('appLogo').src = savedLogo;

            const today = new Date();
            const w = getWeekNumber(today);
            populateWeekSelectors(w.year, w.week);

            const session = sessionStorage.getItem('ssb_user_server');
            if (session) {
                currentUser = JSON.parse(session);
                await loadAppData();
            }
        }

        async function loadAppData() {
            try {
                state = await fetchData();
                document.getElementById('authSection').style.display = 'none';
                document.getElementById('appSection').style.display = 'flex';
                updateUI();
            } catch (err) {
                console.error(err);
                showToast("Gagal mengambil data dari server", true);
            }
        }

        // --- AUTH ---
        function toggleAuth(type) {
            document.getElementById('loginBox').style.display = type === 'login' ? 'block' : 'none';
            document.getElementById('registerBox').style.display = type === 'register' ? 'block' : 'none';
        }

        async function handleLogin(e) {
            e.preventDefault();
            const u = document.getElementById('loginUser').value;
            const p = document.getElementById('loginPass').value;
            const res = await apiLogin({ username: u, password: p });
            
            if(res.user) {
                currentUser = res.user;
                sessionStorage.setItem('ssb_user_server', JSON.stringify(currentUser));
                showToast("Login Berhasil!");
                await loadAppData();
            } else {
                showToast(res.message || "Login Gagal", true);
            }
        }

        async function handleRegister(e) {
            e.preventDefault();
            const data = {
                name: document.getElementById('regName').value,
                username: document.getElementById('regUser').value,
                password: document.getElementById('regPass').value
            };
            const res = await apiRegister(data);
            if(res.user) {
                showToast("Registrasi Berhasil! Silakan Login.");
                toggleAuth('login');
            } else {
                showToast(res.message, true);
            }
        }

        function logout() {
            sessionStorage.removeItem('ssb_user_server');
            location.reload();
        }

        // --- CORE LOGIC ---
        function updateUI() {
            // Kalkulasi Dashboard
            let income = 0, expense = 0, totalTunggakan = 0;
            state.transactions.forEach(t => {
                const amt = parseInt(t.amount);
                if(t.type === 'in' || t.type === 'spp') income += amt;
                if(t.type === 'out') expense += amt;
                if(t.type === 'spp') {
                    const tg = BIAYA_SPP - amt;
                    if(tg > 0) totalTunggakan += tg;
                }
            });
            const saldo = income - expense;
            document.getElementById('totalSaldo').innerText = formatRupiah(saldo);
            document.getElementById('totalMasuk').innerText = formatRupiah(income);
            document.getElementById('totalKeluar').innerText = formatRupiah(expense);
            document.getElementById('totalTunggakanDash').innerText = formatRupiah(totalTunggakan);

            // Update Tables Income/Expense
            const inBody = document.getElementById('incomeTableBody');
            inBody.innerHTML = state.transactions.filter(t => t.type === 'in').sort((a,b)=>new Date(b.date)-new Date(a.date))
                .map(t => `<tr><td>${t.date}</td><td>${t.desc}</td><td>${formatRupiah(t.amount)}</td></tr>`).join('');

            const outBody = document.getElementById('expenseTableBody');
            outBody.innerHTML = state.transactions.filter(t => t.type === 'out').sort((a,b)=>new Date(b.date)-new Date(a.date))
                .map(t => `<tr><td>${t.date}</td><td>${t.desc}</td><td>${formatRupiah(t.amount)}</td></tr>`).join('');
            
            if(document.getElementById('spp').classList.contains('active')) renderSppTable();
        }

        function renderSppTable() {
            const sppBody = document.getElementById('sppTableBody');
            sppBody.innerHTML = '';
            const selectedYear = parseInt(document.getElementById('selectYear').value);
            const selectedWeek = parseInt(document.getElementById('selectWeek').value);
            
            let uniqueNames = new Set([...state.users.map(u=>u.name), ...state.transactions.filter(t=>t.type==='spp').map(t=>t.playerName)]);
            let sortedNames = Array.from(uniqueNames).sort();
            
            let weekTotalArrears = 0; let unpaidCount = 0;

            sortedNames.forEach(playerName => {
                const existingTrans = state.transactions.find(t => t.type==='spp' && t.playerName===playerName && t.year===selectedYear && t.week===selectedWeek);
                
                let status = '<span style="color:#999;">Belum Bayar</span>';
                let amountDisplay = '-';
                let actionBtn = `<button onclick="openSppModal('${playerName}', ${selectedYear}, ${selectedWeek})" class="btn btn-sm btn-edit">Bayar</button>`;
                let currentTunggakan = BIAYA_SPP;
                let tunggakanText = '';

                if(existingTrans) {
                    const tunggakan = BIAYA_SPP - existingTrans.amount;
                    currentTunggakan = tunggakan > 0 ? tunggakan : 0;
                    if(tunggakan > 0) {
                        status = '<span style="background:#ffebee; color:#c62828; padding:2px 8px; border-radius:4px; font-size:0.8rem;">Kurang</span>';
                        tunggakanText = `<div style="font-size:0.8rem; color:#d32f2f;">Tunggakan: ${formatRupiah(tunggakan)}</div>`;
                    } else {
                        status = '<span style="background:#e8f5e9; color:#2e7d32; padding:2px 8px; border-radius:4px; font-size:0.8rem;">Lunas</span>';
                    }
                    amountDisplay = formatRupiah(existingTrans.amount);
                    actionBtn = `<button onclick="editSpp(${existingTrans.id})" class="btn btn-sm btn-edit">Edit</button>`;
                } else {
                    tunggakanText = `<div style="font-size:0.8rem; color:#d32f2f;">Tunggakan: ${formatRupiah(BIAYA_SPP)}</div>`;
                }

                if(currentTunggakan > 0) { weekTotalArrears += currentTunggakan; unpaidCount++; }

                sppBody.innerHTML += `
                    <tr>
                        <td><strong>${playerName}</strong></td>
                        <td>Minggu ${selectedWeek} (${selectedYear})</td>
                        <td>${status} ${tunggakanText}</td>
                        <td style="color:${currentTunggakan > 0 ? '#d32f2f' : '#388e3c'}; font-weight:bold;">${formatRupiah(currentTunggakan)}</td>
                        <td style="font-weight:bold;">${amountDisplay}</td>
                        <td>${actionBtn}</td>
                    </tr>`;
            });

            document.getElementById('weekTotalArrears').innerText = formatRupiah(weekTotalArrears);
            document.getElementById('weekUnpaidCount').innerText = unpaidCount;
        }

        // --- ACTIONS ---
        async function submitPembayaran(e) {
            e.preventDefault();
            const editId = document.getElementById('editSppId').value;
            const playerName = document.getElementById('inputPemain').value;
            const year = parseInt(document.getElementById('inputYear').value);
            const week = parseInt(document.getElementById('inputWeek').value);
            const tanggal = document.getElementById('inputTanggal').value;
            const jumlah = parseInt(document.getElementById('inputJumlah').value);
            
            const weekDateObj = getWeekNumber(new Date(tanggal));

            if (editId) {
                await apiUpdateTransaction(editId, {
                    playerName, date: tanggal, amount: jumlah,
                    year: weekDateObj.year, week: weekDateObj.week
                });
            } else {
                await apiAddTransaction({
                    type: 'spp', playerName, date: tanggal, amount: jumlah,
                    desc: 'Pembayaran SPP', year: weekDateObj.year, week: weekDateObj.week
                });
            }
            closeModal(); showToast("SPP Disimpan");
            await loadAppData(); // Refresh data
        }

        async function submitTransaction(e, type) {
            e.preventDefault();
            const ket = document.getElementById(`inputKet${type==='in'?'In':'Out'}`).value;
            const tgl = document.getElementById(`inputDate${type==='in'?'In':'Out'}`).value;
            const jml = document.getElementById(`inputJml${type==='in'?'In':'Out'}`).value;
            
            await apiAddTransaction({ type, date: tgl, amount: jml, desc: ket });
            closeModal(); showToast("Data Disimpan");
            await loadAppData();
        }

        // --- HELPERS ---
        function openSppModal(name, y, w) {
            document.getElementById('editSppId').value = '';
            document.getElementById('editPlayerName').value = name;
            document.getElementById('inputPemain').value = name;
            document.getElementById('inputYear').value = y;
            document.getElementById('inputWeek').value = w;
            document.getElementById('inputJumlah').value = '';
            document.getElementById('modalSppTitle').innerText = 'Input Pembayaran SPP';
            document.getElementById('inputTanggal').valueAsDate = new Date();
            document.getElementById('modalSpp').classList.add('open');
        }

        function editSpp(id) {
            const t = state.transactions.find(x => x.id === id);
            if(t) {
                document.getElementById('editSppId').value = t.id;
                document.getElementById('editPlayerName').value = t.playerName;
                document.getElementById('inputPemain').value = t.playerName;
                document.getElementById('inputYear').value = t.year;
                document.getElementById('inputWeek').value = t.week;
                document.getElementById('inputTanggal').value = t.date;
                document.getElementById('inputJumlah').value = t.amount;
                document.getElementById('modalSppTitle').innerText = 'Edit Pembayaran SPP';
                document.getElementById('modalSpp').classList.add('open');
            }
        }

        function getWeekNumber(d) {
            d = new Date(Date.UTC(d.getFullYear(), d.getMonth(), d.getDate()));
            d.setUTCDate(d.getUTCDate() + 4 - (d.getUTCDay()||7));
            var yearStart = new Date(Date.UTC(d.getUTCFullYear(),0,1));
            var weekNo = Math.ceil(( ( (d - yearStart) / 86400000) + 1)/7);
            return { year: d.getUTCFullYear(), week: weekNo };
        }

        function populateWeekSelectors(y, w) {
            const ySel = document.getElementById('selectYear');
            const wSel = document.getElementById('selectWeek');
            ySel.innerHTML = ''; wSel.innerHTML = '';
            for(let i=y-1; i<=y+1; i++) ySel.add(new Option(i, i, false, i===y));
            for(let i=1; i<=53; i++) wSel.add(new Option(i, i, false, i===w));
        }

        function formatRupiah(a) { return 'Rp ' + parseInt(a).toLocaleString('id-ID'); }
        
        function showToast(msg, err) {
            const t = document.getElementById('toast'); t.innerText = msg;
            t.style.background = err ? '#d32f2f' : '#333'; t.classList.add('show');
            setTimeout(()=>t.classList.remove('show'), 3000);
        }

        function handleLogoUpload(input) {
            if(input.files && input.files[0]) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    document.getElementById('appLogo').src = e.target.result;
                    localStorage.setItem('ssb_logo', e.target.result);
                    showToast("Logo tersimpan di browser ini");
                };
                reader.readAsDataURL(input.files[0]);
            }
        }

        // Navigation & Modal Utils
        function nav(id) {
            document.querySelectorAll('.section').forEach(e=>e.classList.remove('active'));
            document.getElementById(id).classList.add('active');
            document.querySelectorAll('.nav-menu button').forEach(e=>e.classList.remove('active'));
            document.getElementById('btn-'+id).classList.add('active');
            if(id==='spp') renderSppTable();
        }
        function openModal(t) { document.getElementById('modal'+(t.charAt(0).toUpperCase()+t.slice(1))).classList.add('open'); }
        function closeModal() { document.querySelectorAll('.modal').forEach(m=>m.classList.remove('open')); }
        function openAddManual() { openSppModal('', parseInt(document.getElementById('selectYear').value), parseInt(document.getElementById('selectWeek').value)); document.getElementById('inputPemain').focus(); }

        init();
    </script>
</body>
</html>
```